\newpage
\section{Use cases}

Use cases for ESTCube-2 \gls{obc} software updating system are derived from ESTCube-1 experience as to what might be needed later on. Differences between the two missions are taken into account where applicable.

\subsection{ESTCube-1 experience}

ESTCube-1 \gls{cdhs} received 20 distinct firmware updates during its mission, with 19 of them being successful \cite{Suenter2016}. Size of the changes in corresponding source codes was analyzed.

On average, $2.09\% (s=3.52\%)$ of the code lines were added, removed or edited during a firmware update. The largest update changed $14.71\%$ of the code, while the smallest update only modified $0.02\%$ of all the lines. Updates with largest code changes were so due to addition of large portions of new code, and size of the source code gradually increased through the mission (from $63'390$ lines of code to $78'868$, a $24.42\%$ increase). However, all updates contained modifications and removals as well.

As it was on ESTCube-1, a minor code modification could result in binary difference of almost $99\%$, which caused the need to upload entire firmware image again every time. Size of a typical \gls{cdhs} firmware image after compilation was $250$ \glspl{kib}. Those images had a Shanon entropy of about $0.6$ (on the scale of $0-1$), resulting in theoretical maximum compression ratio of $40\%$. \cite{Suenter2016}

\subsection{Use cases during ESTCube-2 mission}

Due to limited number of suitable launches (caused mostly by limited funding possibilities), it might happen that some software functionality is not completed or sufficiently tested before the launch. In such case, significant amount of new code would need to be added to the firmware with an update. Additionally, some previous code would need to be modified to make use of this new functionality. However, largest parts of the firmware by size - \gls{os} and \gls{hal} - must definitely be finalized before the launch in order to enable successful satellite operation. This means that the size of even the largest such update would stay under about $20\%$.

Several software components are experimental. In order to assess properties of novel solutions, they need to be compared with existing methods, which could mean the need to deploy alternative algorithms for some period of time. Swapping out a software component could still not cause changes larger than introducing a new feature.

The testing of novel software solutions would also entails the need for iterative improvements, as the perfect setup is unlikely to be struck on first try. While most of this should be possible by only changing external configuration values, it might happen that some unforeseen change does require code rewriting. Those kinds of updates would only affect small number of components and would alter significantly less than $1\%$ of the firmware.

When bugs are discovered in on-board software, a fix needs to be developed and deployed. Such update would typically consist mainly of changes to existing code, and can be expected to change considerably less than $1\%$ of the firmware. Changes would also be limited to a single component or functionality. When a bug is discovered, it is vital to deploy the fix as soon as possible, to minimize the probability of any mission critical risks materializing.

Unforeseen issues are also possible with the satellite hardware, due to the use of \gls{cots} components, extreme miniaturization, and educational nature of development process. Some of them could be circumvented with software workarounds, and such updates are very similar to previously mentioned bugfixes.

Lastly, the main mission of ESTCube-2 is to conduct experiments, like unreeling the E-Sail. During such experiment, it might be useful to rapidly deploy new small subroutines that handle aspects of the experiment that were not predicted beforehand.